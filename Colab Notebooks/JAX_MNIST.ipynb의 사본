{"nbformat":4,"nbformat_minor":0,"metadata":{"colab":{"name":"JAX_MNIST.ipynb의 사본","provenance":[{"file_id":"1zehG3-PHNMXBQ8pNAlU9VSC93HkfE2jz","timestamp":1660790100875}],"collapsed_sections":[]},"kernelspec":{"name":"python3","display_name":"Python 3"},"language_info":{"name":"python"},"accelerator":"GPU","gpuClass":"standard","widgets":{"application/vnd.jupyter.widget-state+json":{"1ee2e12f28a448fcbd41e4e6da5f6643":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_55517464c8c74507b49d6c1b821f7b36","IPY_MODEL_b5091f2edfdd47118511885f8ca51c4a","IPY_MODEL_c9ba838cb39b4cdc84b3e40f6efa56a3"],"layout":"IPY_MODEL_7d38ce52f2624e8e8baab37bc610c458"}},"55517464c8c74507b49d6c1b821f7b36":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_4796cc17bd6f4c05853f1a061c9affb0","placeholder":"​","style":"IPY_MODEL_35190c67518d41789d03ce625a403c1b","value":"100%"}},"b5091f2edfdd47118511885f8ca51c4a":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_b71c003f6ffb4a19b8f46bfa7d048466","max":9912422,"min":0,"orientation":"horizontal","style":"IPY_MODEL_fd25aea57216418f8c12af3a545c45b6","value":9912422}},"c9ba838cb39b4cdc84b3e40f6efa56a3":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_15dd07a135da455e86366252425e9e0a","placeholder":"​","style":"IPY_MODEL_c43e617d9c104deeaed3b26681549a4e","value":" 9912422/9912422 [00:00&lt;00:00, 149040390.76it/s]"}},"7d38ce52f2624e8e8baab37bc610c458":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"4796cc17bd6f4c05853f1a061c9affb0":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"35190c67518d41789d03ce625a403c1b":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"b71c003f6ffb4a19b8f46bfa7d048466":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"fd25aea57216418f8c12af3a545c45b6":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"15dd07a135da455e86366252425e9e0a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"c43e617d9c104deeaed3b26681549a4e":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"c8e0ffa3b8944a65b47606cb2369a503":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_e1358dfcd18b4e4a9b6d177c3b3e3aad","IPY_MODEL_ecf7b6fb3b874333a127ace56c4d7c6d","IPY_MODEL_082d302a520748ae92be939b719bcf7a"],"layout":"IPY_MODEL_e1ac1a6b814441afbc0f5d33c828c1eb"}},"e1358dfcd18b4e4a9b6d177c3b3e3aad":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_397ac8ca871e42e5943b4ce2937f8e3b","placeholder":"​","style":"IPY_MODEL_4d389624ca8748b5b915148656126cea","value":"100%"}},"ecf7b6fb3b874333a127ace56c4d7c6d":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_1694c78080614f4ea1434a111c50b1f0","max":28881,"min":0,"orientation":"horizontal","style":"IPY_MODEL_01bcc4b3f4f74d19adb81899aa8d89ec","value":28881}},"082d302a520748ae92be939b719bcf7a":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_b5087a5c9bc44dd18f66f7011a17d033","placeholder":"​","style":"IPY_MODEL_57d2a21d5aac4501850908c324797c9f","value":" 28881/28881 [00:00&lt;00:00, 934811.62it/s]"}},"e1ac1a6b814441afbc0f5d33c828c1eb":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"397ac8ca871e42e5943b4ce2937f8e3b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"4d389624ca8748b5b915148656126cea":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"1694c78080614f4ea1434a111c50b1f0":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"01bcc4b3f4f74d19adb81899aa8d89ec":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"b5087a5c9bc44dd18f66f7011a17d033":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"57d2a21d5aac4501850908c324797c9f":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"229b1d98fafb4dff91f0db6db0af8bb2":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_e167f84b7cb24efea96f624a4cb9f05f","IPY_MODEL_645ac8a94c6a4721be1a5210ebfcfdfe","IPY_MODEL_6bb06d518dc441f0a5c023d46c21181b"],"layout":"IPY_MODEL_a881c6f426ce4037993965d3cca8eef5"}},"e167f84b7cb24efea96f624a4cb9f05f":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_32b9c91204de4b80b97d12229caedfc1","placeholder":"​","style":"IPY_MODEL_b19985bf00af42d388148234d73a3dd0","value":"100%"}},"645ac8a94c6a4721be1a5210ebfcfdfe":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_6a0646ed232b4dbc91c0b399ac7899d6","max":1648877,"min":0,"orientation":"horizontal","style":"IPY_MODEL_f726187cf38c4a5590b85d4e7018d01b","value":1648877}},"6bb06d518dc441f0a5c023d46c21181b":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_2722273d9e6b44fbb46d11c857dac112","placeholder":"​","style":"IPY_MODEL_23fd2bf66d9c47e890c151c3b616a65f","value":" 1648877/1648877 [00:00&lt;00:00, 42110498.54it/s]"}},"a881c6f426ce4037993965d3cca8eef5":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"32b9c91204de4b80b97d12229caedfc1":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"b19985bf00af42d388148234d73a3dd0":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"6a0646ed232b4dbc91c0b399ac7899d6":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"f726187cf38c4a5590b85d4e7018d01b":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"2722273d9e6b44fbb46d11c857dac112":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"23fd2bf66d9c47e890c151c3b616a65f":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"81efff57915e48acbca1ecdb75cfbff6":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_a43437b106bc4b69b5b2a9536b73e183","IPY_MODEL_69ed129673b1444f862cf10129b24ea8","IPY_MODEL_5848418ce3324426aab97f4db5d5a1fc"],"layout":"IPY_MODEL_0aadcfa4f8f14e499a3b9e8d3c0a2735"}},"a43437b106bc4b69b5b2a9536b73e183":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_87579ee5d510450084536d025620333d","placeholder":"​","style":"IPY_MODEL_5581a4ebac0d4b54800e15220f4ef3e9","value":"100%"}},"69ed129673b1444f862cf10129b24ea8":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_8cb81d65c0de4c5688c949cea59a539d","max":4542,"min":0,"orientation":"horizontal","style":"IPY_MODEL_718666a2ac2c439c9cc0019905be84fc","value":4542}},"5848418ce3324426aab97f4db5d5a1fc":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_a9687bc890c54627a3f66bdffec70422","placeholder":"​","style":"IPY_MODEL_20ddb8a20d7743c79afac35bbeeba5c4","value":" 4542/4542 [00:00&lt;00:00, 163197.46it/s]"}},"0aadcfa4f8f14e499a3b9e8d3c0a2735":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"87579ee5d510450084536d025620333d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"5581a4ebac0d4b54800e15220f4ef3e9":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"8cb81d65c0de4c5688c949cea59a539d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"718666a2ac2c439c9cc0019905be84fc":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"a9687bc890c54627a3f66bdffec70422":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"20ddb8a20d7743c79afac35bbeeba5c4":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}}}}},"cells":[{"cell_type":"markdown","source":["산업수학 기반 데이터 분석 프로그램\n","\n","김병천 (wizardbc@gmail.com)<br>\n","인하대학교 응용수학연구소 / 스마트소셜 AI 연구소\n","\n","2022년 8월 18일 (목)<br>\n","더케이호텔 서울, 금강A홀\n","\n","# Neural Network from Scratch (JAX)\n","\n","* 런타임 > 런타임 유형 변경 > 하드웨어 가속기 > GPU\n","\n","```\n","Devices: [GpuDevice(id=0, process_index=0)]\n","```\n","\n","* Input: $x$ (28x28=784, flatten)\n","* Label: $y$ (10, one-hot encoding)\n","* Parameters: $\\theta$\n","* Model: $f(x;\\theta)$\n","* Goal: find $\\theta$ such that $f(x;\\theta) \\approx y$\n","* How: stochastic gradient descent\n","\n"],"metadata":{"id":"kYGApMo-f1Cz"}},{"cell_type":"code","execution_count":1,"metadata":{"id":"K6Vit3x3fxAP","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1660790414981,"user_tz":-540,"elapsed":9852,"user":{"displayName":"김현태","userId":"03086644637186436559"}},"outputId":"37118e0e-0518-414e-f20a-410b9e375542"},"outputs":[{"output_type":"stream","name":"stdout","text":["\u001b[K     |████████████████████████████████| 145 kB 29.7 MB/s \n","\u001b[K     |████████████████████████████████| 76 kB 6.2 MB/s \n","\u001b[?25hDevices: [GpuDevice(id=0, process_index=0)]\n"]}],"source":["# For some low-memmory GPUs.\n","# %env XLA_PYTHON_CLIENT_PREALLOCATE=false\n","\n","import jax\n","import jax.numpy as jnp\n","from jax import grad, jit, vmap\n","from jax import random\n","\n","import numpy as np\n","from torch.utils.data import DataLoader\n","from torchvision.datasets.mnist import MNIST\n","\n","from functools import partial\n","import time\n","import matplotlib.pyplot as plt\n","\n","## Optax (Optimizers in JAX)\n","try:\n","    import optax\n","except ModuleNotFoundError: # Install optax if missing\n","    !pip install --quiet optax\n","    import optax\n","\n","# Seeding for random operations\n","prng_key = random.PRNGKey(42)\n","\n","print(\"Devices:\", jax.devices())"]},{"cell_type":"markdown","source":["## MNIST dataset (28x28)"],"metadata":{"id":"0u2EbygjhfQ2"}},{"cell_type":"code","source":["train_set = MNIST(root='./datasets', train=True, download=True, transform=lambda x: np.ravel(np.array(x, dtype=jnp.float32)))\n","test_set = MNIST(root='./datasets', train=False, download=True, transform=lambda x: np.ravel(np.array(x, dtype=jnp.float32)))\n","\n","len(train_set), len(test_set)"],"metadata":{"id":"98ipQLo4gPpr","colab":{"base_uri":"https://localhost:8080/","height":454,"referenced_widgets":["1ee2e12f28a448fcbd41e4e6da5f6643","55517464c8c74507b49d6c1b821f7b36","b5091f2edfdd47118511885f8ca51c4a","c9ba838cb39b4cdc84b3e40f6efa56a3","7d38ce52f2624e8e8baab37bc610c458","4796cc17bd6f4c05853f1a061c9affb0","35190c67518d41789d03ce625a403c1b","b71c003f6ffb4a19b8f46bfa7d048466","fd25aea57216418f8c12af3a545c45b6","15dd07a135da455e86366252425e9e0a","c43e617d9c104deeaed3b26681549a4e","c8e0ffa3b8944a65b47606cb2369a503","e1358dfcd18b4e4a9b6d177c3b3e3aad","ecf7b6fb3b874333a127ace56c4d7c6d","082d302a520748ae92be939b719bcf7a","e1ac1a6b814441afbc0f5d33c828c1eb","397ac8ca871e42e5943b4ce2937f8e3b","4d389624ca8748b5b915148656126cea","1694c78080614f4ea1434a111c50b1f0","01bcc4b3f4f74d19adb81899aa8d89ec","b5087a5c9bc44dd18f66f7011a17d033","57d2a21d5aac4501850908c324797c9f","229b1d98fafb4dff91f0db6db0af8bb2","e167f84b7cb24efea96f624a4cb9f05f","645ac8a94c6a4721be1a5210ebfcfdfe","6bb06d518dc441f0a5c023d46c21181b","a881c6f426ce4037993965d3cca8eef5","32b9c91204de4b80b97d12229caedfc1","b19985bf00af42d388148234d73a3dd0","6a0646ed232b4dbc91c0b399ac7899d6","f726187cf38c4a5590b85d4e7018d01b","2722273d9e6b44fbb46d11c857dac112","23fd2bf66d9c47e890c151c3b616a65f","81efff57915e48acbca1ecdb75cfbff6","a43437b106bc4b69b5b2a9536b73e183","69ed129673b1444f862cf10129b24ea8","5848418ce3324426aab97f4db5d5a1fc","0aadcfa4f8f14e499a3b9e8d3c0a2735","87579ee5d510450084536d025620333d","5581a4ebac0d4b54800e15220f4ef3e9","8cb81d65c0de4c5688c949cea59a539d","718666a2ac2c439c9cc0019905be84fc","a9687bc890c54627a3f66bdffec70422","20ddb8a20d7743c79afac35bbeeba5c4"]},"executionInfo":{"status":"ok","timestamp":1660790462670,"user_tz":-540,"elapsed":1312,"user":{"displayName":"김현태","userId":"03086644637186436559"}},"outputId":"d201d3eb-9acc-4663-fd1f-7b7ff5dcf65f"},"execution_count":2,"outputs":[{"output_type":"stream","name":"stdout","text":["Downloading http://yann.lecun.com/exdb/mnist/train-images-idx3-ubyte.gz\n","Downloading http://yann.lecun.com/exdb/mnist/train-images-idx3-ubyte.gz to ./datasets/MNIST/raw/train-images-idx3-ubyte.gz\n"]},{"output_type":"display_data","data":{"text/plain":["  0%|          | 0/9912422 [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"1ee2e12f28a448fcbd41e4e6da5f6643"}},"metadata":{}},{"output_type":"stream","name":"stdout","text":["Extracting ./datasets/MNIST/raw/train-images-idx3-ubyte.gz to ./datasets/MNIST/raw\n","\n","Downloading http://yann.lecun.com/exdb/mnist/train-labels-idx1-ubyte.gz\n","Downloading http://yann.lecun.com/exdb/mnist/train-labels-idx1-ubyte.gz to ./datasets/MNIST/raw/train-labels-idx1-ubyte.gz\n"]},{"output_type":"display_data","data":{"text/plain":["  0%|          | 0/28881 [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"c8e0ffa3b8944a65b47606cb2369a503"}},"metadata":{}},{"output_type":"stream","name":"stdout","text":["Extracting ./datasets/MNIST/raw/train-labels-idx1-ubyte.gz to ./datasets/MNIST/raw\n","\n","Downloading http://yann.lecun.com/exdb/mnist/t10k-images-idx3-ubyte.gz\n","Downloading http://yann.lecun.com/exdb/mnist/t10k-images-idx3-ubyte.gz to ./datasets/MNIST/raw/t10k-images-idx3-ubyte.gz\n"]},{"output_type":"display_data","data":{"text/plain":["  0%|          | 0/1648877 [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"229b1d98fafb4dff91f0db6db0af8bb2"}},"metadata":{}},{"output_type":"stream","name":"stdout","text":["Extracting ./datasets/MNIST/raw/t10k-images-idx3-ubyte.gz to ./datasets/MNIST/raw\n","\n","Downloading http://yann.lecun.com/exdb/mnist/t10k-labels-idx1-ubyte.gz\n","Downloading http://yann.lecun.com/exdb/mnist/t10k-labels-idx1-ubyte.gz to ./datasets/MNIST/raw/t10k-labels-idx1-ubyte.gz\n"]},{"output_type":"display_data","data":{"text/plain":["  0%|          | 0/4542 [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"81efff57915e48acbca1ecdb75cfbff6"}},"metadata":{}},{"output_type":"stream","name":"stdout","text":["Extracting ./datasets/MNIST/raw/t10k-labels-idx1-ubyte.gz to ./datasets/MNIST/raw\n","\n"]},{"output_type":"execute_result","data":{"text/plain":["(60000, 10000)"]},"metadata":{},"execution_count":2}]},{"cell_type":"code","source":["plt.style.use('dark_background')\n","\n","for i in range(6):\n","    ax = plt.subplot(2, 3, i+1, )\n","    elt = test_set[i]\n","    ax.set_title(f'Test {i}, label: {elt[1]}')\n","    ax.imshow(elt[0].reshape(28,28), cmap='gray')\n","plt.tight_layout()\n","plt.show()"],"metadata":{"id":"wsbVfuRMhlkq","colab":{"base_uri":"https://localhost:8080/","height":298},"executionInfo":{"status":"ok","timestamp":1660790472341,"user_tz":-540,"elapsed":1706,"user":{"displayName":"김현태","userId":"03086644637186436559"}},"outputId":"8fff4710-cb22-4ad4-f8d1-13b5e65161dd"},"execution_count":3,"outputs":[{"output_type":"display_data","data":{"text/plain":["<Figure size 432x288 with 6 Axes>"],"image/png":"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\n"},"metadata":{}}]},{"cell_type":"markdown","source":["## Model"],"metadata":{"id":"9lIh8cvwhoxR"}},{"cell_type":"code","source":["layer_sizes = [784, 512, 512, 10]\n","step_size = 0.001\n","num_epochs = 8\n","batch_size = 128\n","n_targets = 10\n","\n","train_loader = DataLoader(train_set, collate_fn=lambda b: tuple([np.stack(s) for s in zip(*b)]), shuffle=True, batch_size=batch_size)\n","\n","train_data = jnp.array(train_set.data, dtype=jnp.float32).reshape(-1, 28*28)\n","train_targets = jax.nn.one_hot(jnp.array(train_set.targets), n_targets)\n","test_data = jnp.array(test_set.data, dtype=jnp.float32).reshape(-1, 28*28)\n","test_targets = jax.nn.one_hot(jnp.array(test_set.targets), n_targets)"],"metadata":{"id":"GYWeRoIChoYm","executionInfo":{"status":"ok","timestamp":1660790645611,"user_tz":-540,"elapsed":1050,"user":{"displayName":"김현태","userId":"03086644637186436559"}}},"execution_count":4,"outputs":[]},{"cell_type":"code","source":["for i, (x, y) in enumerate(train_loader):\n","    print(i, x.shape, y.shape)\n","    break"],"metadata":{"id":"4iv1PX7ZjiMl","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1660790650055,"user_tz":-540,"elapsed":548,"user":{"displayName":"김현태","userId":"03086644637186436559"}},"outputId":"6232e2dd-6a28-4645-dac5-280aa096e87a"},"execution_count":5,"outputs":[{"output_type":"stream","name":"stdout","text":["0 (128, 784) (128,)\n"]}]},{"cell_type":"code","source":["def init_network_params(key, sizes):\n","    params = []\n","    for i, (d_in, d_out) in enumerate(zip(sizes[:-1], sizes[1:])):\n","        key, w_key = random.split(key)\n","        w = jax.nn.initializers.lecun_uniform()(w_key, (d_in, d_out))\n","        b = jnp.zeros((d_out,))\n","        params.append({'kernel': w, 'bias':b})\n","    return params\n","\n","prng_key, key = random.split(prng_key)\n","params = init_network_params(prng_key, layer_sizes)\n","jax.tree_util.tree_map(lambda x: x.shape, params)"],"metadata":{"id":"TiYJU7l3sJKC","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1660790936761,"user_tz":-540,"elapsed":1610,"user":{"displayName":"김현태","userId":"03086644637186436559"}},"outputId":"076d0288-6a94-423f-c915-370fd46b432b"},"execution_count":6,"outputs":[{"output_type":"execute_result","data":{"text/plain":["[{'bias': (512,), 'kernel': (784, 512)},\n"," {'bias': (512,), 'kernel': (512, 512)},\n"," {'bias': (10,), 'kernel': (512, 10)}]"]},"metadata":{},"execution_count":6}]},{"cell_type":"markdown","source":["* LogSumExp (LSE)\n","$$LSE(x_1,\\ldots,x_n) = \\log(\\exp(x_1)+\\cdots+\\exp(x_n)).$$\n","\n","* Softmax\n","<br>\n","Note that for any $(x_1,\\ldots,x_n)\\in\\mathbb R^n$, $$\\sum_{i=1}^n p_i = \\sum_{i=1}^n \\frac{\\exp(x_i)}{\\exp(x_1)+\\cdots+\\exp(x_n)} = 1.$$\n","Given $1\\leq m\\leq n$, if $(x_1,\\ldots,x_n)$ is $x_i\\ll 0$ for all $i$ but $x_m\\gg 0$,\n","then we have $$p_m=\\frac{\\exp(x_m)}{\\exp(x_1)+\\cdots+\\exp(x_n)} \\approx 1,$$ which implies\n","$$\\log(p_m)=x_m - LSE(x_1,\\ldots,x_n) \\approx 0.$$\n","\n","* Cross-Entropy $$-\\sum_{i=1}^n t_i\\log(p_i)$$\n","where $t_i$ is the truth label for $i$-th class."],"metadata":{"id":"smPuCLcEsS60"}},{"cell_type":"code","source":["from jax.scipy.special import logsumexp\n","\n","def relu(x):\n","  return jnp.maximum(0, x)\n","\n","def predict(params, image):\n","  x = image\n","  for i, layer in enumerate(params):\n","    w,b = layer['kernel'], layer['bias']\n","    x = jnp.dot(x,w) + b\n","    if i < len(params) - 1:\n","      x = relu(x)\n","  return x-logsumexp(x)\n","\n","# def manually_batched_predict(params, images):\n","#   x = images\n","#   for i, layer in enumerate(params):\n","#     w,b = layer['kernel'], layer['bias']\n","#     x = x@w + b\n","#     if i < len(params) - 1:\n","#       x = relu(x)\n","#   return x-logsumexp(x, axis=1, keepdims=True)"],"metadata":{"id":"qPJnhuqAsNVV","executionInfo":{"status":"ok","timestamp":1660791111711,"user_tz":-540,"elapsed":1043,"user":{"displayName":"김현태","userId":"03086644637186436559"}}},"execution_count":7,"outputs":[]},{"cell_type":"code","source":["predict(params, test_data[0])"],"metadata":{"id":"NxnZRa9csb5-","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1660791126003,"user_tz":-540,"elapsed":1855,"user":{"displayName":"김현태","userId":"03086644637186436559"}},"outputId":"c78d0c59-1cdf-4c97-c562-d3967b47c240"},"execution_count":8,"outputs":[{"output_type":"execute_result","data":{"text/plain":["DeviceArray([ -0.42413712, -62.350563  , -54.443024  , -17.762644  ,\n","              -9.876541  , -16.057682  , -65.20443   , -71.476494  ,\n","             -30.113968  ,  -1.0624352 ], dtype=float32)"]},"metadata":{},"execution_count":8}]},{"cell_type":"code","source":["batched_predict = vmap(predict, in_axes=(None, 0))\n","# batched_predict = manually_batched_predict"],"metadata":{"id":"0Ru8GDxasd4j","executionInfo":{"status":"ok","timestamp":1660791192562,"user_tz":-540,"elapsed":551,"user":{"displayName":"김현태","userId":"03086644637186436559"}}},"execution_count":9,"outputs":[]},{"cell_type":"code","source":["batched_predict(params, test_data[:batch_size]).shape"],"metadata":{"id":"xDtj3qJ7sg2X","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1660791200812,"user_tz":-540,"elapsed":4700,"user":{"displayName":"김현태","userId":"03086644637186436559"}},"outputId":"7ce200bd-2427-4af9-b0b8-56daa88198d0"},"execution_count":10,"outputs":[{"output_type":"execute_result","data":{"text/plain":["(128, 10)"]},"metadata":{},"execution_count":10}]},{"cell_type":"code","source":["def loss_fn(params, images, targets):\n","  preds = batched_predict(params, images)\n","  # return jnp.mean(-vmap(jnp.dot)(targets, preds))\n","  return -jnp.mean(targets * preds)\n","\n","@jit\n","def accuracy(params, images, targets):\n","  target_class = jnp.argmax(targets, axis=1)\n","  predicted_class = jnp.argmax(batched_predict(params, images), axis=1)\n","  return jnp.mean(predicted_class == target_class)"],"metadata":{"id":"sekvYvOBsrRY","executionInfo":{"status":"ok","timestamp":1660791243716,"user_tz":-540,"elapsed":1042,"user":{"displayName":"김현태","userId":"03086644637186436559"}}},"execution_count":11,"outputs":[]},{"cell_type":"code","source":["optimizer = optax.adam(learning_rate=step_size)\n","opt_state = optimizer.init(params)\n","\n","@jit\n","def step(params, opt_state, x, y):\n","    loss_value, grads = jax.value_and_grad(loss_fn)(params, x, y)\n","    updates, opt_state = optimizer.update(grads, opt_state, params)\n","    params = optax.apply_updates(params, updates)\n","    return params, opt_state, loss_value"],"metadata":{"id":"8dKMwf7ss3MD","executionInfo":{"status":"ok","timestamp":1660791248711,"user_tz":-540,"elapsed":2,"user":{"displayName":"김현태","userId":"03086644637186436559"}}},"execution_count":12,"outputs":[]},{"cell_type":"code","source":["train_loss = loss_fn(params, train_data, train_targets)\n","train_acc = accuracy(params, train_data, train_targets)\n","test_acc = accuracy(params, test_data, test_targets)\n","\n","print(f\"Loss {train_loss}\")\n","print(f\"Training set accuracy {train_acc}\")\n","print(f\"Test set accuracy {test_acc}\")"],"metadata":{"id":"l52aB8lSt5sp","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1660791260313,"user_tz":-540,"elapsed":8172,"user":{"displayName":"김현태","userId":"03086644637186436559"}},"outputId":"9b3f8ee5-347b-4225-9d5b-6d2a1267a50b"},"execution_count":13,"outputs":[{"output_type":"stream","name":"stdout","text":["Loss 4.459839344024658\n","Training set accuracy 0.10220000147819519\n","Test set accuracy 0.1014999970793724\n"]}]},{"cell_type":"code","source":["for epoch in range(num_epochs):\n","  start_time = time.time()\n","  for x, y in train_loader:\n","    y = jax.nn.one_hot(y, 10)\n","    params, opt_state, loss_value = step(params, opt_state, x, y)\n","  epoch_time = time.time() - start_time\n","\n","  train_loss = loss_fn(params, train_data, train_targets)\n","  train_acc = accuracy(params, train_data, train_targets)\n","  test_acc = accuracy(params, test_data, test_targets)\n","  print(f\"Epoch {epoch} in {epoch_time:0.2f} sec, loss {train_loss:.4f}\")\n","  print(f\"\\tTraining set accuracy {train_acc:.4f}\")\n","  print(f\"\\tTest set accuracy {test_acc:.4f}\")"],"metadata":{"id":"a32M0xa9uCD5","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1660791334782,"user_tz":-540,"elapsed":25032,"user":{"displayName":"김현태","userId":"03086644637186436559"}},"outputId":"4266b47c-12dc-4aa5-f724-729af3b8a077"},"execution_count":14,"outputs":[{"output_type":"stream","name":"stdout","text":["Epoch 0 in 5.18 sec, loss 0.0201\n","\tTraining set accuracy 0.9544\n","\tTest set accuracy 0.9400\n","Epoch 1 in 2.61 sec, loss 0.0097\n","\tTraining set accuracy 0.9744\n","\tTest set accuracy 0.9551\n","Epoch 2 in 2.62 sec, loss 0.0104\n","\tTraining set accuracy 0.9741\n","\tTest set accuracy 0.9561\n","Epoch 3 in 2.60 sec, loss 0.0076\n","\tTraining set accuracy 0.9803\n","\tTest set accuracy 0.9629\n","Epoch 4 in 2.63 sec, loss 0.0084\n","\tTraining set accuracy 0.9785\n","\tTest set accuracy 0.9611\n","Epoch 5 in 2.60 sec, loss 0.0087\n","\tTraining set accuracy 0.9776\n","\tTest set accuracy 0.9586\n","Epoch 6 in 3.12 sec, loss 0.0065\n","\tTraining set accuracy 0.9826\n","\tTest set accuracy 0.9628\n","Epoch 7 in 2.82 sec, loss 0.0043\n","\tTraining set accuracy 0.9878\n","\tTest set accuracy 0.9694\n"]}]},{"cell_type":"code","source":[""],"metadata":{"id":"gQSQ6s4w4EC5"},"execution_count":null,"outputs":[]}]}